# 全国计算机三级数据库笔记

## 第一章 数据库结构设计

1. `数据库三级模式`

   > 1. 外模式(子模式用户模式)：是数据库用户的视图
   > 2. 模式(逻辑模式)：全体数据的==逻辑结构==用户不可见，是三级模式的中间部分
   > 3. 内模式(存储模式物理模式)：对应数据库的==物理结构==和==存储方式==
   >
   > ==外模式/模式==保证了数据与程序的==逻辑独立性==
   >
   > ==模式/内模式==保证了==物理独立性==

2. `关系模型`

   > ![](pictures/关系模型.jpg)
   >
   > ==关系模式==描述关系的==静态结构==，而==关系==是==动态==的

3. ==数据字典==是对系统中各类数据描述的集合

4. 

   ![](pictures/概念数据模型.jpg)

5. 查询处理器会为编译好的查询语句生成执行计划,并根据执行计划访问相关数据

6. `实施活动`

   > 包括创建数据库、装载数据、应用程序的编码和调试以及数据库的试运行

   1,2是实施活动，3,4,5是运行和维护活动

   ![](pictures/6.jpg)

7. `视图`

   ![](pictures/7.jpg)

   

8. `数据库应用系统设计`

   > 1. 采用自上而下的ER设计
   > 2. 逻辑设计阶段：设计视图和关系模式的完整性约束
   > 3. 物理设计阶段：将关系模式转换为具体DBMS平台支持的关系表

9. 完成数据库关系模式设计的阶段是==逻辑设计==

10. DBAS生命周期模型中时间最长的是==运行管理与维护==

11. `数据仓库`

    > 不做==日常查询==，也不是==汇总和统计==，主要用于提取数据中的潜在信息和指示

12. ==OLAP==是联系分析处理的英文缩写，==仍使用DBMS存取数据==

13. ==概念模型设计==，为每一个实体集的==实体==命名，而不是==实例==

14. `DBMS设计`

    `规划与分析`

    > - 经济：成本等
    > - 技术：
    > - 操作：是否有==人员资源==
    > - 开发方案

    `需求与分析`

    > - 数据：对数据进行组织存储，从用户视图出发，数据字典
    >
    > - 功能：应当做什么
    >
    > - 性能：应当做到什么程度
    >
    > - 其他
    >
    >   > - 存储
    >   > - 安全性
    >   > - 备份和恢复

    `系统设计`

    > `概念设计阶段`
    >
    > > 1. 数据库概念模型设计
    > > 2. 系统总体设计
    >
    > `逻辑设计阶段`
    >
    > > 1. 逻辑结构设计
    > > 2. 应用程序概要设计
    > > 3. 数据库事务概要设计
    >
    > `物理设计阶段`
    >
    > > 1. 物理结构设计
    > > 2. 应用程序==详细设计==
    > > 3. 事务==详细设计==
    >

    `实现与部署阶段`

    > 1. 建立数据库结构
    > 2. 数据加载
    > 3. 事务和应用程序的编码及测试
    > 4. 系统集成
    > 5. 测试与试运行
    > 6. 系统部署

    `运行管理与维护`

    > 1. 数据库监控与分许
    >
    > 2. 性能优化
    >
    >    > 1. 数据运行环境：用RAID1代替满足密集写作
    >    >
    >    > 2. 数据库参数调整
    >    >
    >    > 3. 模式调整
    >    >
    >    > 4. 存储查询优化
    >    >
    >    >    ==视图==是设计阶段，不是优化阶段

    

15. `数据库完整性`

    > 1. 实体完整性：主键
    > 2. 参照完整性：外键
    > 3. 用户自定义完整性：not null,unique,check

    ==Grant==是定义数据库安全性，赋予操作权限

16. `DBAS性能指标`

    ![](pictures/DBAS性能指标.jpg)

17. `系统规划和定义`

    > 1. 任务陈述
    > 2. 确定任务目标
    > 3. 确定系统范围和边界
    > 4. 确定用户视图

18. ER图转关系模式，一对多时并入到多端，不用转为关系模式

19. `事务规范`

    > 表达==数据处理需求==

    `内容`

    > - 名称
    > - 描述
    > - 所访问的数据项
    > - 用户

20. `日常维护`

    > - 备份与恢复
    > - 完整性维护
    > - 安全性维护
    > - 存储空间管理
    > - 并发控制

21. `系统规划与定义`

    > - 任务陈述
    > - 确定任务目标
    > - 确定系统范围和边界
    > - 确定用户视图

22. 一个属性的值必须取自==唯一的域==

23. `复制数据库的方法`

    > 1. 使用复制数据库向导在服务器之间复制或移动数据库。
    > 2. 还原数据库备份,若要复制整个数据库,可以使用 BACKUP和 RESTORE Transact-SQ语句。通常,还原数据库的完整备份用于因各种原因将数据库从一台计算机复制到其他计算机

24. `用户定义的完整性`

    > ==可以用 CHECK短语指定列值应满足的条件,也可以用触发器约束==,通过服务器自动激活相应的触发器,对数据进行完整性控制。所以触发器或 CHECK约束都可以实现。==但 DEFAULT约束不能实现用户自定义的完整性==,只能表示实体或参照完整性

25. 当用户被赋予的两种角色的权限出现冲突时,为了安全起见,都是==DENY==优先，==DENY==指拒绝操作

26. 对 master、 model、msdb实行==修改之后即备份==,对用户数据库实行==周期性备份==,对 tempdb(临时缓存)==不备份==

27. `并行数据库划分方式`

    > - 轮转法：对关系顺序扫描，保证了元组在多个磁盘上均匀分布
    > - 散列划分：基于划分属性进行散列
    > - 范围划分：按照关系中某个属性的取值范围将数据文件划分为几部分

28. `数据仓库`

    > 面向主题的，集成的，非易失的，随时间不断变化

    > - 不可更新性(不实时同步更新)
    > - 随时间变化性

    粒度

    > 粒度问题是设计数据仓库的个最重要方面。==粒度是指数据仓库的数据单位中保存数据的细化或综合程度的级别==。
    >
    > - 细化程度越==髙==,粒度级就越==小==
    > - 细化程度越==低==,粒度级就越==大==

29. `数据模型三要素`

    > - 数据结构：所研究对象的集合，描述了客观世界本身对象和数据之间的联系，是对系统静态描述
    > - 数据操作：主要指检索和更新，对系统动态的描述
    > - 完整性约束：完整性规则的集合，规定数据库状态和满足条件

30. `前三项且并列`

    ```sql
    TOP 3 WITH TIES
    ```

31. `UML图`

    ### 活动图

    ### 用例图

    ### 类图

    ### 顺序图

    ### 通信图

32. `赋予权限`

    <img src="pictures/赋予权限.jpg" style="zoom:500%" />

33. 数据库管理系统一般通过周期性检查==事务等待图==来实现死锁检测

34. 事务并发修改数据破坏了数据==隔离性==

35. `数据库系统故障后恢复`

    > - 故障发生前已经提交的事务(有BEGIN,COMMIT记录)：执行==REDO==操作
    > - 故障发生时尚未完成的事务(只有BEGIN，没有COMMIT或ROLLBACK)：执行==UNDO==

36. `并行数据库`

    > - 完全共享资源结构：共享硬件，数据存取要通过公共路线
    > - 完全不共享资源结构：由多个小系统代替

37. `ER图转实体关系`

    > - 一对多时：在多的那一方加入一的主码
    > - 多对多：==新创建==一个关系模式，由两个实体主码构成和联系的属性
    
38. ==函数依赖==研究关系中属性之间的依赖关系

39. `数据库并发控制锁`

    > 锁：特殊的二元信号量，用来控制并发事务对共享资源的使用

    > - 排它锁：当事务T加上后，可以对数据进行==读和写==，其他任何事务不能再加==任何锁==
    > - 共享锁：事务T加上后，可以对数据进行==读==，其他事务只能加==共享锁==，只有等到该数据没有被任何事务访问才能加==排它锁==

40. 动态转储：利用==转储文件==和==日志文件==综合使用才能使数据库恢复到一致状态

41. ==CHECK==约束

    > - 只有一列时：放在列后面
    > - 有多列时要放在最后面

42. `数据管理与数据分析形式`

    > - OLTP：微观操作，==面向中上层和决策者使用==，通常对==一条记录==操作，要求快速响应，对数据安全性等==要求很高==
    > - OLAP：宏观操作，通常对海量数据操作，查询操作非常复杂

43. `整型类型`

    > - tinyint：0-255
    > - smallint：-2^15^~2^15^-1
    > - int：-2^31^~2^31^-1
    > - bigint：-2^63^~2^63^-1

44. `划分方式`

    > - 轮转划分：对关系顺序扫描，将第i个元组存储到标号为Dimod磁盘上，保证了在==磁盘均匀分布==
    > - 散列划分：选定一个函数，对关系中元组基于==划分属性==散列，如果散列函数返回i，则将其存储到第i个磁盘
    > - 范围划分：根据表中==某个属性取值区间==划分成不同的子区间
    > - 多维划分：用人们逻辑认知从维度来划分

45. COUNT(==DISTINCT== 列名)，用来消除指定列重复值

46. `创建视图，索引，存储过程，触发器，游标`

    > - 视图

    ```sql
    /*通常不包含ORDER BY和DISTINCT*/
    CREATE VIEW 视图名(列名)
    AS
    SELECT...
    [WITH CHECK OPTION]/*用来操作时满足视图定义的谓词条件*/
    ```

    > - 索引

    ```sql
    CREATE [UNIQUE] INDEX 索引名
    ON 表名(列名)
    ```

    > - 存储过程

    ```sql
    CREATE PROCEDURE 存储名 @输入参数 类型,@输出参数 类型 OUTPUT
    AS
    DECLARE
    @参数名1 类型
    BEGIN
    IF ... THEN
    ...
    END IF
...
    END
```
    
    
    
    > - 触发器
    >
    >   不能再视图上定义==FOR/AFTER==，after可以在同一个操作建立多个触发器，instead of只能在同一个操作建一个
    
    ````sql
    CREATE TRIGGER 触发器名
    ON 表名/视图名
    [FOR][INSTEAD OF] [INSERT][UPDATE][DELETE]
    AS
    	DECLARE @变量名 类型
    	[FROM INSERTED/DELETED]
    ...
    END
    ````



# 抢答规则

> 1. 每次抢答开始主持人都会发送emoji表情:heart:来做开头，抢答者==发送弹幕1==，抽第一个来作答并==输入答案到弹幕上==
> 2. 答对为止，答错继续开始抢答
> 3. 在此期间请勿刷表情，谢谢配合



# 抢麦规则

> 1. 主持人宣布开始后，==主持人==选择==麦序模式==，==抢答者==点击==上方麦克风==进入抢麦界面抢麦
> 2. 抢麦第一个成功后，点击下方==开始发言==进行发言，每个人限时==两分钟==，超过则会==提醒==，再超过就会==控麦==以停止你发言
> 3. 每一轮发言结束后，主持人会提醒==所有人==下麦，然后宣布开始新一轮抢麦










